(function(){var d=document,s=d.getElementsByTagName('script'),m=s[s.length - 1],p=m.src.slice(0,m.src.lastIndexOf('/')+1);audioPlayer=function(){var audio=d.createElement('audio');if(audio.play && audio.canPlayType('audio/mpeg') !=''){this.type='audio';this.audio=audio;this.audio.id='x'+Math.random().toString(36).substring(2);this.audio.preload='none';d.body.appendChild(this.audio);var that=this;this.audio.addEventListener('error',function(){that.loaderror='Sound could not be loaded via audio: networkState Error #'+that.audio.networkState;that.error(that.loaderror);},true);}else{this.type='flash';var id='x'+Math.random().toString(36).substring(2);var div=d.createElement('div');div.innerHTML='<object id="'+id+'" data="'+p+'../../plugins/audioplayer/audioplayer.swf" type="application/x-shockwave-flash" style="position:absolute;width:1px;height:1px;top:-1px;"><param name="movie" value="'+p+'../../plugins/audioplayer/audioplayer.swf"></object>';d.body.appendChild(div);this.flash=d.getElementById(id);this.flash.id=id;var that=this;this.flash.xonerror=function(msg){that.error('Sound could not be loaded via flash: Sound '+msg);}}};audioPlayer.prototype={play:function(url,volume,loop,delay){volume=parseInt(volume)||100;volume=(volume<0||volume>100)?100:volume;volume=volume/100;delay=parseInt(delay)||0;if(this.type=='audio'){if(this.lasturl !=url){if(!this.source){this.source=d.createElement('source');this.source.type='audio/mpeg';this.source.src=url;this.audio.appendChild(this.source);}else this.source.src=url;this.lasturl=url;this.loaderror='';this.audio.load();}if(this.loaderror)return this.error(this.loaderror);this.audio.volume=volume;this.stop();this.audio.play();var that=this;if(loop){this.audio.a=function(){that.timeout=setTimeout(function(){that.audio.play();},delay);if(that.onended)that.onended();};this.audio.addEventListener('ended',this.audio.a,true);}else{this.audio.b=function(){that.stop();that.audio.removeEventListener('ended',that.audio.b,true);if(that.onended)that.onended();};this.audio.addEventListener('ended',this.audio.b,true);}return true;}else{if(!('PercentLoaded' in this.flash))return this.error('Audio tag or mp3 format is not supported. Flash is also not supported or it is disabled.');else if(this.flash.PercentLoaded() !=100)return this.error('Audio tag or mp3 format is not supported. Flash is not loaded so far - try some timeout between initialization and playing.');this.stop();this.flash.xsetid(this.flash.id);this.flash.xplay(url,volume);var that=this;if(loop){this.flash.xonended=function(){that.timeout=setTimeout(function(){that.flash.xrepeat();},delay);if(that.onended)that.onended();}}else{this.flash.xonended=function(){that.stop();if(that.onended)that.onended();}}return true;}},stop:function(){if(this.type=='audio'){if(this.audio.currentTime){this.audio.currentTime=0;this.audio.pause();}if(this.timeout)clearTimeout(this.timeout);this.audio.removeEventListener('ended',this.audio.a,true);this.audio.removeEventListener('ended',this.audio.b,true);return true;}else{if(!('PercentLoaded' in this.flash)||this.flash.PercentLoaded() !=100)return false;this.flash.xstop();if(this.timeout){clearTimeout(this.timeout);this.flash.xonended=null;}return true;}},error:function(msg){try{console.log(msg);}catch(e){null;}if(this.onerror)this.onerror(msg);return false;}};})();